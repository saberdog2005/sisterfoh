<!DOCTYPE html>
<html>
<head>
    <title>Sales Log</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
        .container { max-width: 1024px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .summary { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 20px; }
        .log { border-top: 1px solid #ccc; padding-top: 20px; }
        .transaction { padding: 10px; border-bottom: 1px solid #eee; }
        h1 { margin-top: 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Sales Log</h1>
        <div class="summary">
            <p>Cash Sales: $<span id="cashSales">0.00</span></p>
            <p>Card Sales: $<span id="cardSales">0.00</span></p>
            <p>Comp Count: <span id="compCount">0</span></p>
            <p>Ticket Count: <span id="ticketCount">0</span></p>
            <p>Total Sales: $<span id="totalSales">0.00</span></p>
            <p>Thru Door: <span id="doorCount">0</span></p>
        </div>
        <div class="log" id="transactionLog"></div>
    </div>
    <script>
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzdoFgive1pD6OhgFEEZJiiFGZRGeLylu-qI99MhzS-2mLtMQ4uTceyXJU6dnDVv-PV/exec'; // Replace with your web app URL

        async function fetchData() {
            try {
                const response = await fetch(`${WEB_APP_URL}?action=getLogData`);
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                processData(data);
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        function processData(data) {
            let cashSales = 0, cardSales = 0, compCount = 0, ticketCount = 0, totalSales = 0, doorCount = 0;
            const log = document.getElementById('transactionLog');
            log.innerHTML = '';
            data.forEach(row => {
                if (row[0] === 'TRANSACTION') {
                    const total = parseFloat(row[5]) || 0;
                    const note = row[6] || '';
                    const door = parseInt(row[7]) || 0;
                    totalSales += total;
                    doorCount += door;
                    const div = document.createElement('div');
                    div.className = 'transaction';
                    div.textContent = `${row[3]} - $${total.toFixed(2)} - Note: ${note}`;
                    log.appendChild(div);
                }
            });
            document.getElementById('cashSales').textContent = cashSales.toFixed(2);
            document.getElementById('cardSales').textContent = cardSales.toFixed(2);
            document.getElementById('compCount').textContent = compCount;
            document.getElementById('ticketCount').textContent = ticketCount;
            document.getElementById('totalSales').textContent = totalSales.toFixed(2);
            document.getElementById('doorCount').textContent = doorCount;
        }

        setInterval(fetchData, 5000); // Update every 5 seconds
        fetchData(); // Initial fetch
    </script>
</body>
</html>
