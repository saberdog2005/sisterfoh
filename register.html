<!DOCTYPE html>
<html>
<head>
    <title>Sister Bar Register</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
        .container { max-width: 1024px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .header input { margin-right: 10px; padding: 5px; border: 1px solid #ccc; border-radius: 4px; }
        .transaction-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; }
        .transaction-button { padding: 20px; font-size: 16px; border: none; border-radius: 6px; cursor: pointer; transition: transform 0.2s, background 0.3s; }
        .transaction-button:hover { transform: scale(1.05); }
        .cash { background: #4CAF50; color: white; }
        .cash:hover { background: #45a049; }
        .cc { background: #f44336; color: white; }
        .cc:hover { background: #e53935; }
        .ticket { background: #2196F3; color: white; }
        .ticket:hover { background: #1e88e5; }
        .comp { background: #FFC107; color: black; }
        .comp:hover { background: #ffb300; }
        .custom { background: #9E9E9E; color: white; padding: 10px; }
        .custom:hover { background: #757575; }
        .custom input { width: 60px; margin: 5px 0; }
        .custom button { background: #2196F3; padding: 5px 10px; }
        .totals { margin-top: 20px; font-size: 18px; }
        .note { margin-top: 10px; width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        .log-sale { margin-top: 20px; padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; }
        .log-sale:hover { background: #45a049; }
        #toggleSales { padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; }
        #toggleSales:hover { background: #45a049; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <label>Date: <input type="date" id="date"></label>
                <label>Venue: <input type="text" id="venue" value="Sister"></label>
                <label>Event: <input type="text" id="event" value="Open Mic"></label>
                <label>Cashier: <input type="text" id="cashier" value="Default"></label>
            </div>
            <button id="toggleSales">Open Sales</button>
        </div>
        <div class="transaction-grid">
            <button class="transaction-button cash" data-type="cash" data-amount="20">CASH $20</button>
            <button class="transaction-button cash" data-type="cash" data-amount="15">CASH $15</button>
            <button class="transaction-button cash" data-type="cash" data-amount="12">CASH $12</button>
            <button class="transaction-button cash" data-type="cash" data-amount="10">CASH $10</button>
            <button class="transaction-button cash" data-type="cash" data-amount="7">CASH $7</button>
            <button class="transaction-button cash" data-type="cash" data-amount="5">CASH $5</button>
            <button class="transaction-button cc" data-type="cc">CC TRANS</button>
            <button class="transaction-button ticket" data-type="ticket">TICKET</button>
            <button class="transaction-button comp" data-type="comp">COMP</button>
            <div class="transaction-button custom">
                <label>CASH (CUSTOM): <input type="number" id="customAmount" step="0.01"></label>
                <button id="addCustom">Add</button>
            </div>
        </div>
        <div class="totals">
            <span>Cash Total: $<span id="cashTotal">0.00</span></span>
            <span>Thru Door: <span id="thruDoor">0</span></span>
        </div>
        <textarea class="note" id="note" placeholder="Add a note..."></textarea>
        <button class="log-sale" id="logSale">Log Sale</button>
    </div>
    <script>
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzdoFgive1pD6OhgFEEZJiiFGZRGeLylu-qI99MhzS-2mLtMQ4uTceyXJU6dnDVv-PV/exec'; // Replace with your web app URL
        let sessionId = null;
        let cashTotal = 0;
        let thruDoor = 0;

        document.getElementById('toggleSales').addEventListener('click', () => {
            if (!sessionId) {
                const date = document.getElementById('date').value;
                const venue = document.getElementById('venue').value;
                const event = document.getElementById('event').value;
                const cashier = document.getElementById('cashier').value;
                if (!date || !venue || !event || !cashier) {
                    alert('Please fill in all fields');
                    return;
                }
                sessionId = Date.now().toString();
                fetch(WEB_APP_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type: 'SESSION_START', sessionId, date, venue, eventName: event, cashier })
                });
                document.getElementById('toggleSales').textContent = 'Close Sales';
            } else {
                const pin = prompt('Enter PIN to close sales (default: 1234)');
                if (pin === '1234') {
                    fetch(WEB_APP_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ type: 'SESSION_CLOSE', sessionId, grandTotal: cashTotal })
                    });
                    sessionId = null;
                    cashTotal = 0;
                    thruDoor = 0;
                    updateTotals();
                    document.getElementById('toggleSales').textContent = 'Open Sales';
                } else {
                    alert('Incorrect PIN');
                }
            }
        });

        document.querySelectorAll('.transaction-button').forEach(button => {
            if (button.classList.contains('custom')) return;
            button.addEventListener('click', () => {
                if (!sessionId) {
                    alert('Please open a session first');
                    return;
                }
                const type = button.getAttribute('data-type');
                const amount = parseFloat(button.getAttribute('data-amount') || 0);
                if (type === 'cash') cashTotal += amount;
                if (type === 'ticket' || type === 'comp') thruDoor++;
                updateTotals();
            });
        });

        document.getElementById('addCustom').addEventListener('click', () => {
            if (!sessionId) {
                alert('Please open a session first');
                return;
            }
            const amount = parseFloat(document.getElementById('customAmount').value);
            if (!isNaN(amount) && amount > 0) {
                cashTotal += amount;
                updateTotals();
                document.getElementById('customAmount').value = '';
            }
        });

        document.getElementById('logSale').addEventListener('click', () => {
            if (!sessionId) {
                alert('Please open a session first');
                return;
            }
            const note = document.getElementById('note').value;
            fetch(WEB_APP_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    type: 'TRANSACTION',
                    sessionId,
                    timestamp: new Date().toISOString(),
                    time: new Date().toLocaleTimeString(),
                    itemList: [],
                    total: cashTotal,
                    note,
                    doorCount: thruDoor
                })
            });
            cashTotal = 0;
            thruDoor = 0;
            updateTotals();
            document.getElementById('note').value = '';
        });

        function updateTotals() {
            document.getElementById('cashTotal').textContent = cashTotal.toFixed(2);
            document.getElementById('thruDoor').textContent = thruDoor;
        }
    </script>
</body>
</html>
