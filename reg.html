<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Register</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .header, .footer {
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            padding: 15px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #1a73e8;
            color: white;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        button:hover:not(:disabled) {
            background-color: #1557b0;
        }
        .totals, .note-area {
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            height: 60px;
            margin-top: 10px;
        }
        #logSaleBtn {
            background-color: #28a745;
        }
        #logSaleBtn:hover:not(:disabled) {
            background-color: #218838;
        }
        #openSalesBtn {
            background-color: #007bff;
        }
        #editLayoutBtn {
            background-color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Sales Register</h1>
            <p id="sessionInfo">Session: Not Started</p>
        </div>
        <div class="button-grid" id="buttonGrid"></div>
        <div class="totals">
            <p>Cash Total: $<span id="cashTotal">0.00</span></p>
            <p>Thru Door: <span id="doorCount">0</span></p>
        </div>
        <div class="note-area">
            <label for="noteInput">Note:</label>
            <textarea id="noteInput" placeholder="Enter any notes..."></textarea>
            <button id="logSaleBtn" disabled>Log Sale</button>
        </div>
        <div class="footer">
            <button id="openSalesBtn">Open Sales</button>
            <button id="editLayoutBtn" disabled>Edit Layout</button>
        </div>
    </div>

    <script>
        class SalesApp {
            constructor() {
                this.sessionActive = false;
                this.cashTotal = 0;
                this.doorCount = 0;
                this.items = [];
                this.defaultButtons = [
                    { label: "CASH $20", cash: 20, count: 1 },
                    { label: "CASH $40", cash: 40, count: 2 },
                    { label: "CASH $60", cash: 60, count: 3 },
                    { label: "CC TRANS", cash: 0, count: 1 },
                    { label: "COMP", cash: 0, count: 0 }
                ];
                this.initUI();
                this.loadSession();
            }

            initUI() {
                const buttonGrid = document.getElementById('buttonGrid');
                this.defaultButtons.forEach(btn => {
                    const button = document.createElement('button');
                    button.textContent = btn.label;
                    button.disabled = !this.sessionActive;
                    button.addEventListener('click', () => this.addItem(btn));
                    buttonGrid.appendChild(button);
                });

                document.getElementById('openSalesBtn').addEventListener('click', () => this.toggleSession());
                document.getElementById('logSaleBtn').addEventListener('click', () => this.logSale());
            }

            updateUI() {
                document.getElementById('cashTotal').textContent = this.cashTotal.toFixed(2);
                document.getElementById('doorCount').textContent = this.doorCount;
                document.getElementById('logSaleBtn').disabled = !this.sessionActive || this.items.length === 0;
                document.getElementById('editLayoutBtn').disabled = this.sessionActive;
                const buttons = document.querySelectorAll('.button-grid button');
                buttons.forEach(btn => btn.disabled = !this.sessionActive);
                document.getElementById('sessionInfo').textContent = this.sessionActive
                    ? `Session: ${new Date().toLocaleString()} | Venue: Main | Event: General | Cashier: Admin`
                    : 'Session: Not Started';
            }

            toggleSession() {
                if (this.sessionActive) {
                    this.sessionActive = false;
                    this.cashTotal = 0;
                    this.doorCount = 0;
                    this.items = [];
                } else {
                    this.sessionActive = true;
                }
                localStorage.setItem('sessionActive', this.sessionActive);
                this.updateUI();
            }

            loadSession() {
                this.sessionActive = localStorage.getItem('sessionActive') === 'true';
                this.updateUI();
            }

            addItem(button) {
                if (!this.sessionActive) return;
                this.cashTotal += button.cash;
                if (button.count > 0) this.doorCount += button.count;
                this.items.push(`${button.label}: ${button.count} @ $${button.cash.toFixed(2)}`);
                this.updateUI();
            }

            async logSale() {
                if (!this.sessionActive || this.items.length === 0) return;
                const transaction = {
                    timestamp: new Date().toISOString(),
                    items: this.items.join(', '),
                    cashTotal: this.cashTotal,
                    doorCount: this.doorCount,
                    note: document.getElementById('noteInput').value.trim()
                };

                try {
                    const response = await fetch('YOUR_WEB_APP_URL', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(transaction)
                    });
                    if (!response.ok) throw new Error('Failed to log sale to server');
                    console.log('Sale logged successfully');
                } catch (error) {
                    console.error('Error logging sale:', error);
                    // Fallback to local storage or retry logic could be added here
                }

                this.cashTotal = 0;
                this.items = [];
                document.getElementById('noteInput').value = '';
                this.updateUI();
            }
        }

        const app = new SalesApp();
    </script>
</body>
</html>
